#include "mbed.h"
#include <cstdint>

AnalogOut Aout(D7);
AnalogIn Ain(A0);
int sample = 361;
double raw_data[361] = {0, 0.05235456, 0.10467724, 0.15693624, 0.20909991, 0.26113683,
 0.3130159,  0.36470638, 0.41617799, 0.46740099, 0.51834619, 0.56898509,
 0.61928987, 0.66923351, 0.71878979, 0.76793337, 0.81663983, 0.86488573,
 0.91264858, 0.95990696, 1.0066405,  1.05282989, 1.09845696, 1.14350463,
 1.18795694, 1.23179909, 1.2750174,  1.31759933, 1.35953347, 1.40080953,
 1.44141833, 1.48135179, 1.52060289, 1.55916568, 1.59703523, 1.63420763,
 1.67067992, 1.70645012, 1.74151713, 1.77588076, 1.80954166, 1.84250129,
 1.87476187, 1.90632639, 1.93719852, 1.96738261, 1.99688362, 2.02570713,
 2.05385924, 2.08134659, 2.10817629, 2.13435591, 2.15989341, 2.18479714,
 2.2090758,  2.23273838, 2.25579418, 2.27825272, 2.30012376, 2.32141725,
 2.34214331, 2.36231218, 2.38193425, 2.40101998, 2.41957991, 2.43762462,
 2.45516473, 2.47221089, 2.4887737,  2.50486377, 2.52049168, 2.53566793,
 2.55040297, 2.56470719, 2.57859086, 2.59206417, 2.6051372 , 2.61781992,
 2.63012216, 2.64205363, 2.65362389, 2.66484237, 2.67571835, 2.68626094,
 2.69647912, 2.70638168, 2.71597728, 2.72527438, 2.7342813 , 2.74300619,
 2.75145701, 2.75964157, 2.7675675,  2.77524227, 2.78267317, 2.78986733,
 2.79683171, 2.80357311, 2.81009814, 2.81641328, 2.82252482, 2.82843891,
 2.83416154, 2.83969854, 2.84505557, 2.85023817, 2.85525172, 2.86010144,
 2.86479243, 2.86932962, 2.87371785, 2.87796176, 2.88206592, 2.88603473,
 2.88987248, 2.89358334, 2.89717133, 2.90064039, 2.90399432, 2.90723682,
 2.91037146, 2.91340174, 2.91633101, 2.91916255, 2.92189954, 2.92454503,
 2.92710202, 2.92957338, 2.93196193, 2.93427036, 2.93650132, 2.93865733,
 2.94074087, 2.94275432, 2.9447,     2.94658014, 2.94839691, 2.95015242,
 2.95184869, 2.95348768, 2.95507131, 2.95660141, 2.95807977, 2.95950812,
 2.96088811, 2.96222137, 2.96350946, 2.96475389, 2.96595613, 2.96711758,
 2.96823962, 2.96932357, 2.97037071, 2.97138228, 2.97235947, 2.97330344,
 2.97421531, 2.97509617, 2.97594706, 2.97676898, 2.97756293, 2.97832984,
 2.97907063, 2.97978618, 2.98047734, 2.98114495, 2.9817898 , 2.98241266,
 2.98301427, 2.98359536, 2.98415663, 2.98469874, 2.98522235, 2.98572808,
 2.98621654, 2.98668833, 2.987144,   2.9875841 , 2.98800917, 2.98841971,
 2.98881623, 2.98881623, 2.98841971, 2.98800917, 2.9875841 , 2.987144,
 2.98668833, 2.98621654, 2.98572808, 2.98522235, 2.98469874, 2.98415663,
 2.98359536, 2.98301427, 2.98241266, 2.9817898 , 2.98114495, 2.98047734,
 2.97978618, 2.97907063, 2.97832984, 2.97756293, 2.97676898, 2.97594706,
 2.97509617, 2.97421531, 2.97330344, 2.97235947, 2.97138228, 2.97037071,
 2.96932357, 2.96823962, 2.96711758, 2.96595613, 2.96475389, 2.96350946,
 2.96222137, 2.96088811, 2.95950812, 2.95807977, 2.95660141, 2.95507131,
 2.95348768, 2.95184869, 2.95015242, 2.94839691, 2.94658014 ,2.9447,
 2.94275432, 2.94074087, 2.93865733, 2.93650132, 2.93427036 ,2.93196193,
 2.92957338, 2.92710202, 2.92454503, 2.92189954, 2.91916255 ,2.91633101,
 2.91340174, 2.91037146, 2.90723682, 2.90399432, 2.90064039, 2.89717133,
 2.89358334, 2.88987248, 2.88603473, 2.88206592, 2.87796176, 2.87371785,
 2.86932962, 2.86479243, 2.86010144, 2.85525172, 2.85023817, 2.84505557,
 2.83969854, 2.83416154, 2.82843891, 2.82252482, 2.81641328, 2.81009814,
 2.80357311, 2.79683171, 2.78986733, 2.78267317, 2.77524227, 2.7675675,
 2.75964157, 2.75145701, 2.74300619, 2.7342813 , 2.72527438, 2.71597728,
 2.70638168, 2.69647912, 2.68626094, 2.67571835, 2.66484237, 2.65362389,
 2.64205363, 2.63012216, 2.61781992, 2.6051372 , 2.59206417, 2.57859086,
 2.56470719, 2.55040297, 2.53566793, 2.52049168, 2.50486377, 2.4887737,
 2.47221089, 2.45516473, 2.43762462, 2.41957991, 2.40101998, 2.38193425,
 2.36231218, 2.34214331, 2.32141725, 2.30012376, 2.27825272, 2.25579418,
 2.23273838, 2.2090758,  2.18479714, 2.15989341, 2.13435591, 2.10817629,
 2.08134659, 2.05385924, 2.02570713, 1.99688362, 1.96738261, 1.93719852,
 1.90632639, 1.87476187, 1.84250129, 1.80954166, 1.77588076, 1.74151713,
 1.70645012, 1.67067992, 1.63420763, 1.59703523, 1.55916568, 1.52060289,
 1.48135179, 1.44141833, 1.40080953, 1.35953347, 1.31759933, 1.2750174,
 1.23179909, 1.18795694, 1.14350463, 1.09845696, 1.05282989, 1.0066405,
 0.95990696, 0.91264858, 0.86488573, 0.81663983, 0.76793337, 0.71878979,
 0.66923351, 0.61928987, 0.56898509, 0.51834619, 0.46740099, 0.41617799,
 0.36470638, 0.3130159,  0.26113683, 0.20909991, 0.15693624, 0.10467724,
 0.05235456};
int i;

// main() runs in its own thread in the OS
int main()
{
    uint16_t data[361];
    for (i = 0; i < sample; i++){
            data[i] = (uint16_t)((raw_data[i])/3 * 0xFFFF);
    }
    while (true) {
        for (i = 0; i < sample; i++) {
            Aout.write_u16(data[i]);
        }
    }
}

